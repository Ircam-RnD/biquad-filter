var assert = require('assert');
var BiquadFilter = require('../biquad-filter.es6.js')

describe("BiquadFilter tests", function() {
    var bf = new BiquadFilter()
    it('should get the right number of cascadeFilters', function() {
        var inputCoef = [2, 1, 1, 1, 1, 1, 1, 1, 1];
        var nb = bf.getNumberOfCascadeFilters(inputCoef);
        assert.equal(nb, 2);
    });
    it('should set coefficient properly if input coef are fine', function() {
        var inputCoef = [2, 1, 2, 3, 4, 5, 6, 7, 8];
        bf.setCoefficients(inputCoef);
        var coefs = [{
            a1: 3,
            a2: 4,
            b1: 1,
            b2: 2
        }, {
            a1: 7,
            a2: 8,
            b1: 5,
            b2: 6
        }];
        coefs.g = 2;
        assert.deepEqual(bf.coefficients[0], coefs[0]);
        assert.deepEqual(bf.coefficients[1], coefs[1]);
        assert.equal(inputCoef[0], coefs.g);
    });
    it('should throw an exception when no coef is set', function() {
        assert.throws(function() {
            bf.setCoefficients()
        }, Error);
    });
    it('should reset memories', function() {
        var memories = [{
            xi1: 0,
            xi2: 0,
            yi1: 0,
            yi2: 0
        }, {
            yi1: 0,
            yi2: 0
        }]
        var inputCoef = [2, 1, 2, 3, 4, 5, 6, 7, 8];
        bf.setCoefficients(inputCoef);
        bf.resetMemories()
        assert.deepEqual(bf.memories[0], memories[0]);
        assert.deepEqual(bf.memories[1], memories[1]);
    })
    it('should filter correctly an empty buffer', function() {
        var inputBuffer = Array.apply(null, new Array(128)).map(Number.prototype.valueOf, 0);
        var outputBuffer = [];
        bf.process(inputBuffer, outputBuffer);
        assert.deepEqual(inputBuffer, outputBuffer);
    })
    it('should filter sound correctly - test 1', function() {
        // other input tests
        var inputCoef = [1.531136140336, -1.611583816367, 0.669821989608, -1.740187327854, 0.822587179044, -1.756475532982, 0.905713368891, -1.648787390226, 0.828729819757, -0.645272711327, 0.826197804655, -0.783377686179, 0.581697106286, -1.953161331463, 0.982067430640, -1.930201382596, 0.957622063648, 0.051024237316, 0.560497444138, 0.551835271319, 0.573926366263, -1.981192029527, 0.982806747597, -1.984366957140, 0.985941272430];
        var outputBuffer = [];
        var inputBuffer = [1.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000]
        var supposedOutputBuffer = [1.531136140336, -0.553621639610, 0.743315322215, 0.196550992976, -0.556018167965, -0.188101407238, -0.073656026837, -0.196459840334, 0.045098145901, 0.140521016570, -0.016977662779, -0.019030735000, 0.037802187444, -0.004214449641, -0.017011676341, 0.002089192927, -0.020162664362, -0.029013362756, 0.000328526710, 0.022293044174, 0.036226507670, 0.054941336944, 0.062743433093, 0.057799005684, 0.050492526259, 0.037821430878, 0.018029062796, -0.002262436701, -0.020362175751, -0.035791584281, -0.045586594315, -0.048886567271, -0.047308109794, -0.041692000251, -0.033047144387, -0.023309310775, -0.013900775533, -0.005679166202, 0.000552159897, 0.004517660598, 0.006540289060, 0.007085864193, 0.006706601188, 0.006031028413, 0.005535411303, 0.005484008232, 0.005987724026, 0.006982962330, 0.008257288192, 0.009547015549, 0.010594812346, 0.011186649727, 0.011197566149, 0.010604190313, 0.009466786854, 0.007909271208, 0.006091540743, 0.004174783566, 0.002295974337, 0.000553029303, -0.001002587793, -0.002362520972, -0.003549392853, -0.004601988614, -0.005560287388, -0.006452527388, -0.007287425185, -0.008052203443, -0.008715466017, -0.009234019350, -0.009561937202, -0.009659638143, -0.009501372584, -0.009080061030, -0.008408848287, -0.007519494907, -0.006458315578, -0.005280594183, -0.004044526237, -0.002805692489, -0.001612783087, -0.000504954406, 0.000489113666, 0.001350691224, 0.002069439862, 0.002641333808, 0.003066551599, 0.003347730397, 0.003488817203, 0.003494582518, 0.003370717048, 0.003124326410, 0.002764586922, 0.002303330133, 0.001755371274, 0.001138471374, 0.000472907594, -0.000219296704, -0.000915374539, -0.001592913823, -0.002230913763, -0.002810683757, -0.003316507572, -0.003736040168, -0.004060446612, -0.004284325310, -0.004405477080, -0.004424586663, -0.004344875876, -0.004171771527, -0.003912611075, -0.003576389414, -0.003173534743, -0.002715692456, -0.002215494049, -0.001686292366, -0.001141853265, -0.000596004608, -0.000062253991, 0.000446605202, 0.000918875190, 0.001344297806, 0.001714339352, 0.002022400353, 0.002263941599, 0.002436525394, 0.002539777559, 0.002575280624, 0.002546411471, 0.002458137466, 0.002316784233, 0.002129786235, 0.001905428860, 0.001652588344, 0.001380474053, 0.001098376488, 0.000815424082, 0.000540352046, 0.000281287139, 0.000045552831, -0.000160500253, -0.000331633773, -0.000463826707, -0.000554342711, -0.000601758003, -0.000605949622, -0.000568045625, -0.000490340356, -0.000376179204, -0.000229818191, -0.000056264276, 0.000138897615, 0.000349684914, 0.000569899592, 0.000793307139, 0.001013807888, 0.001225596745, 0.001423307950, 0.001602141985, 0.001757972244, 0.001887429561, 0.001987963232, 0.002057877717, 0.002096344822, 0.002103391805, 0.002079866501, 0.002027381213, 0.001948237685, 0.001845335995, 0.001722070604, 0.001582217035, 0.001429812841, 0.001269036463, 0.001104087516, 0.000939071763, 0.000777893763, 0.000624159795, 0.000481093217, 0.000351464009, 0.000237533752, 0.000141016845, 0.000063058304, 0.000004228022, -0.000035469035, -0.000056567637, -0.000060103403, -0.000047561829, -0.000020817119, 0.000017937083, 0.000066262837, 0.000121556599, 0.000181129141, 0.000242284454, 0.000302395467, 0.000358974651, 0.000409737757, 0.000452659237, 0.000486018167, 0.000508433831, 0.000518890428, 0.000516750690, 0.000501758524, 0.000474031063, 0.000434040804, 0.000382588733, 0.000320769569, 0.000249930383, 0.000171624026, 0.000087558845, -0.000000453781, -0.000090552546, -0.000180878503, -0.000269625104, -0.000355084740, -0.000435690638, -0.000510053167, -0.000576989785, -0.000635548093, -0.000685021630, -0.000724958307, -0.000755161549, -0.000775684428, -0.000786817244, -0.000789069174, -0.000783144751, -0.000769916019, -0.000750391333, -0.000725681783, -0.000696966272, -0.000665456257, -0.000632361142, -0.000598855223, -0.000566047053, -0.000534951937, -0.000506468200, -0.000481357699, -0.000460230951, -0.000443537073, -0.000431558614, -0.000424411215, -0.000422047887, -0.000424267611, -0.000430727825, -0.000440960298, -0.000454389804, -0.000470354977, -0.000488130658, -0.000506951087, -0.000526033240, -0.000544599678, -0.000561900297, -0.000577232432, -0.000589958823, -0.000599523049, -0.000605462107, -0.000607415915, -0.000605133600, -0.000598476546, -0.000587418234, -0.000572041042, -0.000552530187, -0.000529165123, -0.000502308719, -0.000472394613, -0.000439913173, -0.000405396485, -0.000369402849, -0.000332501199, -0.000295255898, -0.000258212299, -0.000221883429, -0.000186738123, -0.000153190864, -0.000121593532, -0.000092229220, -0.000065308171, -0.000040965891, -0.000019263365, -0.000000189299, 0.000016335764, 0.000030453656, 0.000042361338, 0.000052302479, 0.000060558115, 0.000067436715, 0.000073263920, 0.000078372278, 0.000083091241, 0.000087737691, 0.000092607242, 0.000097966510, 0.000104046530, 0.000111037459, 0.000119084637, 0.000128286079, 0.000138691391, 0.000150302087, 0.000163073237, 0.000176916339, 0.000191703300, 0.000207271355, 0.000223428748, 0.000239961008, 0.000256637593, 0.000273218730, 0.000289462241, 0.000305130166, 0.000319995027, 0.000333845551, 0.000346491745, 0.000357769186, 0.000367542458, 0.000375707673, 0.000382194040, 0.000386964490, 0.000390015368, 0.000391375241, 0.000391102906, 0.000389284665, 0.000386030981, 0.000381472648, 0.000375756563, 0.000369041276, 0.000361492413, 0.000353278125, 0.000344564670, 0.000335512258, 0.000326271248, 0.000316978796, 0.000307756011, 0.000298705700, 0.000289910709, 0.000281432902, 0.000273312764, 0.000265569619, 0.000258202433, 0.000251191139, 0.000244498446, 0.000238072046, 0.000231847141, 0.000225749220, 0.000219696981, 0.000213605323, 0.000207388316, 0.000200962071, 0.000194247434, 0.000187172436, 0.000179674439, 0.000171701942, 0.000163215994, 0.000154191205, 0.000144616339, 0.000134494490, 0.000123842853, 0.000112692110, 0.000101085468, 0.000089077391, 0.000076732066, 0.000064121658, 0.000051324419, 0.000038422692, 0.000025500887, 0.000012643469, -0.000000066975, -0.000012551550, -0.000024736702, -0.000036555654, -0.000047949617, -0.000058868738, -0.000069272777, -0.000079131502, -0.000088424811, -0.000097142581, -0.000105284266, -0.000112858261, -0.000119881063, -0.000126376261, -0.000132373391, -0.000137906680, -0.000143013748, -0.000147734267, -0.000152108651, -0.000156176786, -0.000159976850, -0.000163544239, -0.000166910632, -0.000170103215, -0.000173144071, -0.000176049753, -0.000178831038, -0.000181492872, -0.000184034478, -0.000186449644, -0.000188727151, -0.000190851340, -0.000192802786, -0.000194559060, -0.000196095557, -0.000197386353, -0.000198405086, -0.000199125809, -0.000199523818, -0.000199576417, -0.000199263601, -0.000198568661, -0.000197478665, -0.000195984835, -0.000194082802, -0.000191772735, -0.000189059350, -0.000185951799, -0.000182463452, -0.000178611581, -0.000174416947, -0.000169903330, -0.000165096986, -0.000160026074, -0.000154720056, -0.000149209092, -0.000143523439, -0.000137692889, -0.000131746231, -0.000125710776, -0.000119611937, -0.000113472889, -0.000107314295, -0.000101154122, -0.000095007531, -0.000088886854, -0.000082801648, -0.000076758814, -0.000070762794, -0.000064815813, -0.000058918181, -0.000053068618, -0.000047264619, -0.000041502825, -0.000035779399, -0.000030090397, -0.000024432120, -0.000018801441, -0.000013196095, -0.000007614928, -0.000002058100, 0.000003472763, 0.000008974470, 0.000014442219, 0.000019869606, 0.000025248684, 0.000030570067, 0.000035823076, 0.000040995927, 0.000046075944, 0.000051049797, 0.000055903755, 0.000060623948, 0.000065196633, 0.000069608443, 0.000073846641, 0.000077899334, 0.000081755681, 0.000085406059, 0.000088842205, 0.000092057318, 0.000095046129, 0.000097804933, 0.000100331581, 0.000102625445, 0.000104687346, 0.000106519457, 0.000108125176, 0.000109508986, 0.000110676289, 0.000111633240, 0.000112386572, 0.000112943411, 0.000113311110, 0.000113497080, 0.000113508638, 0.000113352870, 0.000113036511, 0.000112565851, 0.000111946657, 0.000111184123, 0.000110282842, 0.000109246800, 0.000108079396, 0.000106783481, 0.000105361407, 0.000103815107, 0.000102146178, 0.000100355971, 0.000098445698, 0.000096416533, 0.000094269714, 0.000092006652, 0.000089629015, 0.000087138822, 0.000084538517, 0.000081831029, 0.000079019822, 0.000076108926, 0.000073102958, 0.000070007120, 0.000066827187, 0.000063569478, 0.000060240813, 0.000056848460, 0.000053400071, 0.000049903609, 0.000046367268, 0.000042799391];
        bf.setCoefficients(inputCoef);
        bf.process(inputBuffer, outputBuffer);
        for (var i = 0; i < inputBuffer.length; i++) {
            assert(Math.abs(outputBuffer[i] - supposedOutputBuffer[i]) < 0.0000000001);
        }
    })
    it('should filter sound correctly - test 2', function() {
        // other input tests
        var inputCoef = [0.437773679989, -1.088171411689, 0.351100616928, -1.547164235168, 0.753554906772, -1.957438230746, 0.980192929443, -1.937958166798, 0.956740797477, -1.846278815586, 0.911632623383, -1.881929993256, 0.940837325791, -1.952133068605, 0.956225825088, -1.964429752016, 0.967175771213, -1.831783994871, 0.958987317271, -1.831612666540, 0.948833096093, -0.299843068001, 0.757522482723, 0.224954974259, 0.623212174487];
        var outputBuffer = [];
        var inputBuffer = [1.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000]
        var supposedOutputBuffer = [0.437773679989, -0.016420343509, 0.159105983109, 0.184412754090, -0.010472731715, -0.056556986065, 0.020272935595, 0.001490404987, -0.048942437688, -0.015309049081, 0.028299671727, 0.018535663804, 0.009948612950, 0.026730914753, 0.029270363620, 0.013407976864, 0.007948291047, 0.012310940545, 0.011255014556, 0.009910992438, 0.016591654271, 0.025024681100, 0.029482216286, 0.032961383366, 0.036394775059, 0.036336913710, 0.032396350475, 0.027018206908, 0.020768656621, 0.013304220507, 0.005829023787, -0.000309456813, -0.005028534361, -0.008435257231, -0.010228099530, -0.010469821472, -0.009704803511, -0.008342051228, -0.006606284918, -0.004830605812, -0.003341524440, -0.002251538622, -0.001555592528, -0.001242386905, -0.001232891166, -0.001361846351, -0.001464216489, -0.001412428367, -0.001095710158, -0.000435859601, 0.000579021020, 0.001899099194, 0.003432149049, 0.005047446324, 0.006584205505, 0.007876407749, 0.008775594983, 0.009164551981, 0.008970975726, 0.008179841175, 0.006836200150, 0.005039342676, 0.002932915403, 0.000690486715, -0.001503770336, -0.003475454185, -0.005078020032, -0.006207638640, -0.006813494563, -0.006901652429, -0.006532181121, -0.005810556019, -0.004874415470, -0.003877053431, -0.002969760707, -0.002285206858, -0.001923582890, -0.001942870525, -0.002354223563, -0.003122762195, -0.004173371955, -0.005400609486, -0.006681440969, -0.007889246504, -0.008907452704, -0.009641318645, -0.010026693949, -0.010034956603, -0.009673815940, -0.008984160134, -0.008033556368, -0.006907343966, -0.005698475823, -0.004497332537, -0.003382652437, -0.002414515607, -0.001630023118, -0.001041958656, -0.000640353232, -0.000396541423, -0.000269035204, -0.000210373641, -0.000174048714, -0.000120660297, -0.000022603484, 0.000133185009, 0.000344627809, 0.000595985798, 0.000861094358, 0.001107838586, 0.001303225133, 0.001418369204, 0.001432761156, 0.001337298105, 0.001135743377, 0.000844486480, 0.000490691632, 0.000109117542, -0.000261957253, -0.000585176814, -0.000828366490, -0.000968098908, -0.000992160236, -0.000900655959, -0.000705666886, -0.000429541124, -0.000102065593, 0.000243116759, 0.000572403291, 0.000855981026, 0.001071003376, 0.001203851641, 0.001251258149, 0.001220208100, 0.001126681011, 0.000993423121, 0.000847044774, 0.000714800971, 0.000621433422, 0.000586428203, 0.000621979453, 0.000731855736, 0.000911253897, 0.001147609299, 0.001422224751, 0.001712494968, 0.001994447839, 0.002245302895, 0.002445761786, 0.002581791745, 0.002645733907, 0.002636654507, 0.002559947596, 0.002426282308, 0.002250056550, 0.002047565061, 0.001835109256, 0.001627268163, 0.001435516867, 0.001267326195, 0.001125812441, 0.001009936855, 0.000915189844, 0.000834641679, 0.000760205559, 0.000683943348, 0.000599249967, 0.000501777232, 0.000389998019, 0.000265361325, 0.000132041553, -0.000003665074, -0.000134203659, -0.000251762951, -0.000349285304, -0.000421358069, -0.000464880468, -0.000479432071, -0.000467308432, -0.000433231172, -0.000383778768, -0.000326615944, -0.000269620517, -0.000220014743, -0.000183603371, -0.000164203796, -0.000163327557, -0.000180140402, -0.000211694281, -0.000253393086, -0.000299628205, -0.000344502867, -0.000382557408, -0.000409411236, -0.000422250645, -0.000420112594, -0.000403940379, -0.000376414566, -0.000341588348, -0.000304377653, -0.000269970792, -0.000243228612, -0.000228143968, -0.000227419205, -0.000242204125, -0.000272016489, -0.000314845271, -0.000367416072, -0.000425580784, -0.000484781463, -0.000540532698, -0.000588867708, -0.000626700631, -0.000652069731, -0.000664241872, -0.000663675632, -0.000651856740, -0.000631033328, -0.000603888303, -0.000573191028, -0.000541470239, -0.000510744901, -0.000482340599, -0.000456807171, -0.000433940311, -0.000412897312, -0.000392386455, -0.000370901966, -0.000346972622, -0.000319392277, -0.000287404584, -0.000250821233, -0.000210062212, -0.000166116667, -0.000120432631, -0.000074752126, -0.000030913980, 0.000009350449, 0.000044603724, 0.000073849298, 0.000096623012, 0.000113020463, 0.000123659607, 0.000129585628, 0.000132131683, 0.000132753704, 0.000132859695, 0.000133653714, 0.000136012072, 0.000140404709, 0.000146868843, 0.000155035485, 0.000164203248, 0.000173448545, 0.000181757539, 0.000188163327, 0.000191871963, 0.000192363000, 0.000189453821, 0.000183321754, 0.000174483128, 0.000163733445, 0.000152057187, 0.000140518847, 0.000130148417, 0.000121834591, 0.000116237404, 0.000113729251, 0.000114369561, 0.000117914263, 0.000123857220, 0.000131497267, 0.000140021966, 0.000148597757, 0.000156456058, 0.000162965921, 0.000167685970, 0.000170391130, 0.000171072851, 0.000169914669, 0.000167247679, 0.000163492573, 0.000159096023, 0.000154469381, 0.000149936906, 0.000145699136, 0.000141814893, 0.000138202961, 0.000134662054, 0.000130905587, 0.000126606140, 0.000121443634, 0.000115151092, 0.000107552471, 0.000098588252, 0.000088326201, 0.000076956579, 0.000064772991, 0.000052141726, 0.000039463675, 0.000027133611, 0.000015501697, 0.000004841630, -0.000004671200, -0.000012969453, -0.000020090956, -0.000026164143, -0.000031384123, -0.000035982645, -0.000040195809, -0.000044233428, -0.000048253583, -0.000052345115, -0.000056519739, -0.000060714238, -0.000064802016, -0.000068612172, -0.000071953505, -0.000074640366, -0.000076517214, -0.000077479015, -0.000077485240, -0.000076566070, -0.000074820384, -0.000072406051, -0.000069523963, -0.000066397847, -0.000063252319, -0.000060291716, -0.000057682019, -0.000055537737, -0.000053914939, -0.000052810863, -0.000052169778, -0.000051894051, -0.000051858872, -0.000051928725, -0.000051973649, -0.000051883424, -0.000051578232, -0.000051014773, -0.000050187471, -0.000049124965, -0.000047882622, -0.000046532264, -0.000045150524, -0.000043807348, -0.000042556048, -0.000041426045, -0.000040419052, -0.000039508999, -0.000038645537, -0.000037760520, -0.000036776561, -0.000035616539, -0.000034212864, -0.000032515420, -0.000030497288, -0.000028157663, -0.000025521751, -0.000022637772, -0.000019571562, -0.000016399487, -0.000013200584, -0.000010048864, -0.000007006644, -0.000004119646, -0.000001414300, 0.000001102532, 0.000003441544, 0.000005627031, 0.000007691602, 0.000009670235, 0.000011594456, 0.000013487315, 0.000015359746, 0.000017208678, 0.000019017047, 0.000020755641, 0.000022386467, 0.000023867192, 0.000025156082, 0.000026216847, 0.000027022813, 0.000027559979, 0.000027828629, 0.000027843378, 0.000027631704, 0.000027231191, 0.000026685843, 0.000026041926, 0.000025343813, 0.000024630289, 0.000023931702, 0.000023268218, 0.000022649300, 0.000022074388, 0.000021534630, 0.000021015374, 0.000020499092, 0.000019968362, 0.000019408545, 0.000018809874, 0.000018168726, 0.000017487993, 0.000016776558, 0.000016047988, 0.000015318664, 0.000014605598, 0.000013924225, 0.000013286454, 0.000012699186, 0.000012163484, 0.000011674455, 0.000011221836, 0.000010791192, 0.000010365553, 0.000009927294, 0.000009460022, 0.000008950254, 0.000008388709, 0.000007771075, 0.000007098201, 0.000006375720, 0.000005613164, 0.000004822725, 0.000004017803, 0.000003211536, 0.000002415475, 0.000001638562, 0.000000886491, 0.000000161537, -0.000000537188, -0.000001213086, -0.000001871143, -0.000002516835, -0.000003155037, -0.000003789038, -0.000004419802, -0.000005045556, -0.000005661721, -0.000006261217, -0.000006835068, -0.000007373233, -0.000007865570, -0.000008302805, -0.000008677405, -0.000008984247, -0.000009221035, -0.000009388415, -0.000009489792, -0.000009530889, -0.000009519099, -0.000009462728, -0.000009370198, -0.000009249325, -0.000009106724, -0.000008947409, -0.000008774622, -0.000008589885, -0.000008393254, -0.000008183736, -0.000007959797, -0.000007719895, -0.000007462978, -0.000007188879, -0.000006898557, -0.000006594190, -0.000006279075, -0.000005957394, -0.000005633852, -0.000005313254, -0.000005000063, -0.000004698002, -0.000004409732, -0.000004136663, -0.000003878893, -0.000003635285, -0.000003403679, -0.000003181193, -0.000002964579, -0.000002750601, -0.000002536383, -0.000002319687, -0.000002099104, -0.000001874137, -0.000001645164, -0.000001413317, -0.000001180270, -0.000000947985, -0.000000718447, -0.000000493409, -0.000000274198, -0.000000061576, 0.000000144297, 0.000000343837, 0.000000537917, 0.000000727698, 0.000000914425, 0.000001099212, 0.000001282848, 0.000001465642, 0.000001647327, 0.000001827036, 0.000002003344, 0.000002174375, 0.000002337957, 0.000002491807, 0.000002633726, 0.000002761778, 0.000002874441, 0.000002970706];
        bf.setCoefficients(inputCoef);
        bf.process(inputBuffer, outputBuffer);
        for (var i = 0; i < inputBuffer.length; i++) {
            assert(Math.abs(outputBuffer[i] - supposedOutputBuffer[i]) < 0.0000000001);
        }
    })
});
