<!doctype html>
<html class="no-js" lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>biquad-filter</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    
      <link rel="stylesheet" href="https://rawgit.com/Ircam-RnD/module-boilerplate/master/docs/css/main.css">
    
    
    
      <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js"></script>
    
      <script src="https://rawgit.com/Ircam-RnD/player/master/player.js"></script>
    
      <script src="https://rawgit.com/Ircam-RnD/buffer-loader/master/buffer-loader.js"></script>
    
    
    <script src="./js/biquad-filter.js"></script>
  </head>
  <body>

  <header>
    <nav>
      <ul>
        <li><a class="icon-github" href="https://github.com/Ircam-RnD/biquad-filter">Source on GitHub</a></li>
        <li class="updated"><em>Last updated: July 10th 2014</em></li>
      </ul>
    </nav>
  </header>
  
  <hr>

  <section>
    <h2 id="biquad-filter-library">Biquad Filter library</h2>
<blockquote>
<p>The Biquad Filter is a JavaScript library that implements a cascade of biquad filters</p>
</blockquote>
<p>This library implements a <a href="http://en.wikipedia.org/wiki/Digital_biquad_filter">biquad filter</a> with the possibility of use a cascade of biquad filters where you can specify the coefficients:</p>
<pre><code>                       1 + b1*z^-1 + b2*z^-2
One biquad:   H1(z) = -----------------------
                       1 + a1*z^-1 + a2*z^-2

Cascade of biquads:   H(z) = g 路 H1(z) 路 H2(z) 路 ... 路 Hn(z)   
where g is the global gain of the cascade of biquads and n is the number of biquad filters.
</code></pre>
    <script>
  // The coefficients of the cascade of biquad filters.
  var coef = [0.90338, -0.80434, 0.52878, -1.3264, 0.68112, -1.8567, 0.92083, -1.8476,
   0.92028, -1.8483, 0.95257, -1.8367, 0.93335, -1.9599, 0.98291, -1.9442, 0.96724,
   -1.9795, 0.9825, -1.977, 0.97983, -0.45444, 0.62182, 0.18046, 0.78331];

  // We need an audio context
  var audioContext = new AudioContext();
  var targetNode = audioContext.destination;
  // Create Audio Nodes
  var player = createPlayer();
  var bufferLoader = createBufferLoader();
  var scriptProcessor = audioContext.createScriptProcessor(1024, 1, 1);
  // Connect Audio Nodes
  player.connect(scriptProcessor);
  scriptProcessor.connect(targetNode);

  // Create biquad filter module
  var biquadFilter = createBiquadFilter();
  // Set the coefficients and indicate the number of biquads
  biquadFilter.setCoefficients(coef);

  // Load player file
  bufferLoader.load('./snd/breakbeat.wav').then(function(buffer){
    player.setBuffer(buffer);
    player.enableLoop(true);
    player.start();
  })

  // Process the data inside the scriptProcessor process
  scriptProcessor.onaudioprocess = function(event){
    // Get the input buffer
    var inputBuffer = event.inputBuffer.getChannelData(0);
    // Get the ouput buffer
    var outputBuffer = event.outputBuffer.getChannelData(0);

    // Process the data
    biquadFilter.process(inputBuffer, outputBuffer);
  }
</script>
    <h3 id="example">Example</h3>
<p>This library can be used, for instance, inside the Web Audio API:</p>
<pre><code class="lang-html">    &lt;script src=&quot;/biquad-filter.min.js&quot;&gt;&lt;/script&gt;
    &lt;!-- https://github.com/Ircam-RnD/buffer-loader  We need a way to load and decode the audio file for the player, so we use this lib --&gt;
    &lt;script src=&quot;/examples/js/buffer-loader.js&quot;&gt;&lt;/script&gt;
    &lt;!-- https://github.com/Ircam-RnD/player - We use this player to play a sound --&gt;
    &lt;script src=&quot;/examples/js/player.js&quot;&gt;&lt;/script&gt;
</code></pre>
<pre><code class="lang-js">  // The coefficients of the cascade of biquad filters.
  var coef = [0.90338, -0.80434, 0.52878, -1.3264, 0.68112, -1.8567, 0.92083, -1.8476,
  0.92028, -1.8483, 0.95257, -1.8367, 0.93335, -1.9599, 0.98291, -1.9442, 0.96724,
  -1.9795, 0.9825, -1.977, 0.97983, -0.45444, 0.62182, 0.18046, 0.78331];

  // We need an audio context
  var audioContext = new AudioContext();
  var targetNode = audioContext.destination;
  // Create Audio Nodes
  var player = createPlayer();
  var bufferLoader = createBufferLoader();
  var scriptProcessor = audioContext.createScriptProcessor(1024, 1, 1);
  // Connect Audio Nodes
  player.connect(scriptProcessor);
  scriptProcessor.connect(targetNode);

  // Create biquad filter module
  var biquadFilter = createBiquadFilter();
  // Set the coefficients and indicate the number of biquads
  biquadFilter.setCoefficients(coef);

  // Load player file
  bufferLoader.load(&#39;/examples/snd/breakbeat.wav&#39;).then(function(buffer){
    player.setBuffer(buffer);
    player.enableLoop(true);
    player.start();
  })

  // Process the data inside the scriptProcessor process
  scriptProcessor.onaudioprocess = function(event){
    // Get the input buffer
    var inputBuffer = event.inputBuffer.getChannelData(0);
    // Get the ouput buffer
    var outputBuffer = event.outputBuffer.getChannelData(0);

    // Process the data
    biquadFilter.process(inputBuffer, outputBuffer);
  }
</code></pre>
<h3 id="coefficients-format">Coefficients format</h3>
<p>The input format of the coefficients for the library is a JavaScript Array with all the coefficients:</p>
<p>For one biquad filter:</p>
<pre><code>[g, b1, b2, a1, a2]
</code></pre><p>For two or more biquad filters:</p>
<pre><code>[g, b1_1, b2_1, a1_1, a2_1, b1_2, b2_2, a1_2, a2_2, ... , b1_n, b2_n, a1_n, a2_n ]
</code></pre><p>where n is the number of biquad filters and g is the global gain of the cascade of biquads.</p>
<h3 id="api">API</h3>
<p>The <code>binauralFIR</code> object exposes the following API:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>biquadFilter.setCoefficients(coef)</code></td>
<td>Set the coefficients of the filter. </td>
</tr>
<tr>
<td><code>biquadFilter.process(inputBuffer, outputBuffer)</code></td>
<td>Calculate the output of the cascade biquad filter for an inputBuffer. The inputBuffer and the outputBuffer are Arrays with the same length.</td>
</tr>
</tbody>
</table>

    
  </section>

  <hr>

  <footer>
    
  </footer>
  <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>